commonfields:
  id: CrowdStrikeFalconIntel
  version: -1
name: CrowdStrikeFalconIntel
display: CrowdStrike Falcon Intel v2
category: Data Enrichment & Threat Intelligence
description: Threat intelligence service by CrowdStrike focused on delivering a technical feed to help organizations better defend themselves against adversary activity.
configuration:
- display: Client ID
  name: credentials
  required: true
  type: 9
- display: Server URL (e.g. https://192.168.0.1)
  name: url
  defaultvalue: https://intelapi.crowdstrike.com/
  type: 0
  required: true
- display: API ID
  name: id
  defaultvalue: ""
  type: 0
  required: true
- display: API Key
  name: key
  defaultvalue: ""
  type: 4
  required: true
- display: Indicator Threshold. Minimum malicious confidence from Falcon Intel to
    consider the indicator malicious.(low, medium, high)
  name: threshold
  defaultvalue: high
  type: 0
  required: false
- display: Use system proxy settings
  name: proxy
  type: 8
  required: false
- display: Trust any certificate (not secure)
  name: insecure
  type: 8
  required: false
- display: Support indicator API V2
  name: version
  defaultvalue: "true"
  type: 8
  required: false
script:
  dockerimage: demisto/python3:3.8.3.9324
  type: python
  subtype: python3
  script: '-'
  feed: false
  isfetch: false
  longRunning: false
  longRunningPort: false
  commands:
  - name: file
    arguments:
    - name: file
      required: true
      default: true
      description: The file hash md5/sha1/sha256 to check
    outputs:
    - contextPath: File.MD5
      description: Bad hash MD5
    - contextPath: File.SHA1
      description: Bad hash SHA1
    - contextPath: File.SHA256
      description: Bad hash SHA256
    - contextPath: File.Malicious.Vendor
      description: For malicious files, the vendor that made the decision
    - contextPath: File.Malicious.Description
      description: For malicious files, the reason for the vendor to make the decision
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
    - contextPath: DBotScore.Type
      description: The indicator type.
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
    - contextPath: DBotScore.Score
      description: The actual score.
    description: Check file reputation
  - name: url
    arguments:
    - name: url
      required: true
      default: true
      description: URL to be checked
    outputs:
    - contextPath: URL.Data
      description: Bad URL
    - contextPath: URL.Malicious.Vendor
      description: For malicious URLs, the vendor that made the decision
    - contextPath: URL.Malicious.Description
      description: For malicious URLs, the reason for the vendor to make the decision
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
    - contextPath: DBotScore.Type
      description: The indicator type.
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
    - contextPath: DBotScore.Score
      description: The actual score.
    description: Check the given URL reputation
  - name: domain
    arguments:
    - name: domain
      required: true
      default: true
      description: Domain to be checked
    outputs:
    - contextPath: Domain.Name
      description: Bad domain
    - contextPath: Domain.Malicious.Vendor
      description: For malicious domains, the vendor that made the decision
    - contextPath: Domain.Malicious.Description
      description: For malicious domains, the reason for the vendor to make the decision
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
    - contextPath: DBotScore.Type
      description: The indicator type.
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
    - contextPath: DBotScore.Score
      description: The actual score.
    description: Check the given URL reputation
  - name: ip
    arguments:
    - name: ip
      required: true
      default: true
      description: IP to check
    outputs:
    - contextPath: IP.Address
      description: Bad IP
    - contextPath: IP.Malicious.Vendor
      description: For malicious IPs, the vendor that made the decision
    - contextPath: IP.Malicious.Description
      description: For malicious IPs, the reason for the vendor to make the decision
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
    - contextPath: DBotScore.Type
      description: The indicator type.
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
    - contextPath: DBotScore.Score
      description: The actual score.
    description: Check IP reputation
  - name: cs-actors
    arguments:
    - name: q
      default: true
      description: Search all fields for the given data
    - name: name
      description: Search based on actor name
    - name: description
      description: Search based on description
    - name: created_date
      description: Search range from created date. Dates are formatted as YYYY-MM-DD.
    - name: max_last_modified_date
      description: Search range to modified date. Dates are formatted as YYYY-MM-DD.
    - name: min_last_activity_date
      description: Search range from activity date. Dates are formatted as YYYY-MM-DD.
    - name: max_last_activity_date
      description: Search range to activity date. Dates are formatted as YYYY-MM-DD.
    - name: origins
      description: Search by origins separated by ","
    - name: target_countries
      description: Search by target countries separated by ","
    - name: tagret_industries
      description: Search by target industries separated by ","
    - name: motivations
      description: Search by motivations separated by ","
    - name: offset
      description: Which page of the results to retrieve. It is 0 based.
    - name: limit
      description: Number of results for the page
    - name: sort
      description: Sort is field_name.order, field_name.order where order is either
        asc or desc
    - name: slug
      description: 'Search by ''slug'' or short descriptive name. Ex: "anchor-panda"'
    description: Search known actors based on the given parameters. Dates are formatted
      as YYYY-MM-DD. Max date is taken automatically looking at end-of-day time. Origins,
      targetCountries, targetIndustries and motivations can all receive multiple values
      separated by ",". Offset is 0 based. Sort is field_name.order, field_name.order
      where order is either asc or desc.
  - name: cs-indicators
    arguments:
    - name: type
      required: true
      description: The indicator type
      auto: PREDEFINED
      predefined:
      - binary_string
      - compile_time
      - device_name
      - domain
      - email_address
      - email_subject
      - event_name
      - file_mapping
      - file_name
      - file_path
      - hash_ion
      - hash_md5
      - hash_sha256
      - ip_address
      - ip_address_block
      - mutex_name
      - password
      - persona_name
      - phone_number
      - port
      - registry
      - semaphore_name
      - service_name
      - url
      - user_agent
      - username
      - x509_seria
      - x509_subject
    - name: malicious_confidence
      required: false
      auto: PREDEFINED
      predefined:
      - high
      - medium
      - low
      - unverified
      description: Indicates a confidence level by which an indicator is considered to be malicious.
    - name: offset
      description: Used to paginate the response. You can then use limit to set the
        number of results for the next page.
    - name: last_updated
      description: The date the indicator was last updated.
    - name: indicator
      required: true
      description: The value for the given indicator type
    - name: sort
      description: Sort by a field. Should be field_name.order where order is either
        asc or desc. Fields are indicator, type, report, actor, malicious_confidence,
        published_date, last_updated.
    - name: id
      description: The indicator's ID, in the following format type>_<indicator>
      required: false
      isArray: false
    - default: true
      defaultValue: '10'
      description: The maximum number of indicators to retrieve. The default is 10.
      isArray: false
      name: limit
      required: false
    outputs:
    - contextPath: File.MD5
      description: hash MD5
    - contextPath: File.SHA1
      description: hash SHA1
    - contextPath: File.SHA256
      description: hash SHA256
    - contextPath: File.Malicious.Vendor
      description: For malicious files, the vendor that made the decision
    - contextPath: File.Malicious.Description
      description: For malicious files, the reason for the vendor to make the decision
    - contextPath: File.Reports
      description: For malicious files, the associated reports describing the hash
    - contextPath: File.Actors
      description: For malicious files, the associated actors
    - contextPath: File.MalwareFamilies
      description: For malicious files, the associated malware family
    - contextPath: File.KillChains
      description: For malicious files, the associated kill chain
    - contextPath: URL.Data
      description: Bad URL
    - contextPath: URL.Malicious.Vendor
      description: For malicious URLs, the vendor that made the decision
    - contextPath: URL.Malicious.Description
      description: For malicious URLs, the reason for the vendor to make the decision
    - contextPath: URL.Reports
      description: For malicious URL, the associated reports describing the URL
    - contextPath: URL.Actors
      description: For malicious URL, the associated actors
    - contextPath: URL.MalwareFamilies
      description: For malicious URL, the associated malware family
    - contextPath: URL.KillChains
      description: For malicious URL, the associated kill chain
    - contextPath: Domain.Name
      description: Bad domain
    - contextPath: Domain.Malicious.Vendor
      description: For malicious domains, the vendor that made the decision
    - contextPath: Domain.Malicious.Description
      description: For malicious domains, the reason for the vendor to make the decision
    - contextPath: Domain.Reports
      description: For malicious domain, the associated reports describing the domain
    - contextPath: Domain.Actors
      description: For malicious domain, the associated actors
    - contextPath: Domain.MalwareFamilies
      description: For malicious domain, the associated malware family
    - contextPath: Domain.KillChains
      description: For malicious domain, the associated kill chain
    - contextPath: IP.Address
      description: IP Indicators
    - contextPath: IP.Malicious.Vendor
      description: For malicious IPs, the vendor that made the decision
    - contextPath: IP.Malicious.Description
      description: For malicious IPs, the reason for the vendor to make the decision
    - contextPath: IP.Reports
      description: For malicious IP, the associated reports describing the IP
    - contextPath: IP.Actors
      description: For malicious IP, the associated actors
    - contextPath: IP.MalwareFamilies
      description: For malicious IP, the associated malware family
    - contextPath: IP.KillChains
      description: For malicious IP, the associated kill chain
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
    - contextPath: DBotScore.Type
      description: The type of the indicator
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
    - contextPath: DBotScore.Score
      description: The actual score
    description: Search known indicators based on the given parameters
  - name: cs-reports
    arguments:
    - name: q
      description: Perform a generic substring search across all fields in a report
    - name: name
      description: Search for keywords across report names (i.e. the reportâ€™s title)
    - name: actors
      description: Search for a report related to a particular actors. Actors should be comma separated.
        - For example - actor1,actor2,...
    - name: target_countries
      description: Search reports by targeted country/countries
    - name: target_industries
      description: Search reports by targeted industry/industries
    - name: motivations
      description: Search by motivation
    - name: slug
      description: Search by report 'slug' or short descriptive name
    - name: description
      description: Search the body of the report
    - name: type
      auto: PREDEFINED
      predefined:
      - intelligence report
      - alert
      - periodic report
      - tipper
      description: The type of object to search for.
    - name: sub_type
      auto: PREDEFINED
      predefined:
      - weekly
      - monthly
      - quarterly
      - annual
      description: The sub-type to search for.
    - name: tags
      description: Tags associated with a report (managed internally by CS)
    - name: created_date
      description: Constrain results to those created on a certain date
        - format YYYY-MM-DD
    - name: max_last_modified_date
      description: Constrain results to those modified on or before a certain date
        - format YYYY-MM-DD
    - name: offset
      description: Used to paginate the response. You can then use limit to set the
        number of results for the next page.
    - name: limit
      description: Limits the number of results to return
    - name: sort
      description: 'The field and direction to sort results on in the format of: <field>.<asc>
        or <field>.<desc>. Valid values include: name, target_countries, target_industries,
        type, created_date, last_modified_date'
    description: The Falcon Intel Reports API allows to query CrowdStrike intelligence
      publications.
  - name: cs-report-pdf
    arguments:
    - name: id
      required: true
      default: true
      description: The ID of the report to retrieve
    description: Retrieve the Falcon Intel Report PDF
  runonce: false
tests:
- No tests yet
fromversion: 5.0.0
